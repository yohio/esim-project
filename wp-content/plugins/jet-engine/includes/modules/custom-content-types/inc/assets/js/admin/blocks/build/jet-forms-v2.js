(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{saveType:()=>d});var n={};e.r(n),e.d(n,{getType:()=>g,getTypes:()=>m});var o={};e.r(o),e.d(o,{getType:()=>v});const r=window.React,l=window.wp.i18n,a=window.wp.components,i=window.jfb.components,s=window.jfb.actions,c=window.wp.data,u="SET_TYPES",p=(0,c.combineReducers)({api:function(e={},t){return t?.type===u?{...e,types:t.payload}:e}});function d(e){return({select:t,dispatch:n})=>{const o=t.getTypes();n({type:u,payload:{...o,[e.id]:{...e}}})}}function m(e){var t;return null!==(t=e?.api?.types)&&void 0!==t?t:{}}function g(e,t){return e?.api?.types?.[t]}const y=window.wp.apiFetch;var f=e.n(y);const h=window.wp.url,v=e=>async({dispatch:t})=>{if(!e)return;const n=(0,h.addQueryArgs)(window.JetEngineCCT.fetch_path,{type:e}),{success:o,notices:r,fields:l}=await f()({path:n});if(!o)throw new Error(r?.[0]?.message);const a=[];for(const e of l)"_ID"===e.value&&(e.label+=" (will update the item)"),a.push({...e});t.saveType({id:e,fields:a})},w="jet-engine/cct",_=(0,c.createReduxStore)(w,{reducer:p,actions:t,selectors:n,resolvers:o}),E=function({settings:e,onChangeSettingObj:t,source:n}){const{hasError:o,setShowError:u}=(0,s.useActionValidatorProvider)({isSupported:e=>"type"===e?.property}),{error:p}=(0,c.useSelect)((t=>({error:t(w).getResolutionError("getType",[e.type])})),[e.type]);return(0,r.createElement)(i.RowControl,null,(({id:s})=>{var c;return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(i.RequiredLabel,{htmlFor:s},(0,l.__)("Content Type","jet-engine")),(0,r.createElement)(i.RowControlEnd,{hasError:o||Boolean(p),showDefaultNotice:o},Boolean(p)&&(0,r.createElement)(i.IconText,null,null!==(c=p?.message)&&void 0!==c?c:(0,l.__)("Fetching content type was failed","jet-engine")),(0,r.createElement)(a.SelectControl,{id:s,value:e.type,onChange:e=>t({type:e}),options:[{value:"",label:"--"},...n.types],onBlur:()=>u(!0),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})))}))},b=window.jfb.blocksToActions,T=function({getMapField:e,setMapField:t,settings:n}){const o=(0,b.useFields)({withInner:!1}),{isResolving:a,cctType:u}=(0,c.useSelect)((e=>({isResolving:e(w).isResolving("getType",[n.type]),cctType:e(w).getType(n.type)})),[n.type]);return(0,r.createElement)(i.RowControl,{align:"flex-start"},(0,r.createElement)(i.Label,null,(0,l.__)("Fields map","jet-engine")),(0,r.createElement)(i.RowControlEnd,{gap:4,style:{opacity:a?"0.5":"1"}},o.map((n=>(0,r.createElement)(s.FieldsMapField,{key:n.value,tag:n.value,label:n.label,isRequired:n.required,formFields:[{value:"",label:"--"},...u.fields],value:e({name:n.value}),onChange:e=>t({nameField:n.value,value:e})})))))},C=function({label:e,value:t,onChange:n}){return(0,r.createElement)(a.Card,{elevation:2},(0,r.createElement)(a.Flex,{direction:"column",gap:3,style:{padding:"1em"}},(0,r.createElement)(i.RowControl,{controlSize:1},(({id:o})=>(0,r.createElement)(r.Fragment,null,(0,r.createElement)(i.Label,{htmlFor:o},e),(0,r.createElement)(a.TextControl,{id:o,value:t,onChange:n,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}))))))},F=function({getMapField:e,setMapField:t,settings:n}){const{isResolving:o,cctTypeFields:a}=(0,c.useSelect)((e=>{var t;const o=e(w).getType(n.type);return{isResolving:e(w).isResolving("getType",[n.type]),cctTypeFields:null!==(t=o?.fields?.filter?.((({value:e})=>"_ID"!==e)))&&void 0!==t?t:[]}}),[n.type]);return(0,r.createElement)(i.RowControl,{align:"flex-start"},(0,r.createElement)(i.Label,null,(0,l.__)("Default Fields","jet-engine")),(0,r.createElement)(i.RowControlEnd,{gap:4,style:{opacity:o?"0.5":"1"}},a.map((n=>(0,r.createElement)(C,{key:n.value,label:n.label,value:e({source:"default_fields",name:n.value}),onChange:e=>t({source:"default_fields",nameField:n.value,value:e})})))))},S={type:"insert_custom_content_type",label:(0,l.__)("Insert/Update Custom Content Type Item","jet-engine"),edit:function(e){const{source:t,settings:n,onChangeSettingObj:o}=e,{error:u,cctType:p}=(0,c.useSelect)((e=>({error:e(w).getResolutionError("getType",[n.type]),cctType:e(w).getType(n.type)})),[n.type]);return(0,r.createElement)(a.Flex,{direction:"column"},(0,r.createElement)(E,{...e}),(0,r.createElement)(i.WideLine,null),(0,r.createElement)(s.ValidatedSelectControl,{label:(0,l.__)("Item Status","jet-engine"),value:n.status,onChange:e=>o({status:e}),options:[{value:"",label:"--"},...t.statuses]}),p?.fields?.length&&!Boolean(u)&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(i.WideLine,null),(0,r.createElement)(T,{...e}),(0,r.createElement)(i.WideLine,null),(0,r.createElement)(F,{...e})))},icon:(0,r.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,r.createElement)("rect",{x:"0",fill:"none",width:"20",height:"20"}),(0,r.createElement)("g",null,(0,r.createElement)("path",{d:"M17 7V4h-2V2h-3v1H3v15h11V9h1V7h2zm-1-2v1h-2v2h-1V6h-2V5h2V3h1v2h2z"}))),docHref:"https://crocoblock.com/knowledge-base/jetengine/how-to-insert-update-cct-via-form/",category:"content",validators:[({settings:e})=>!e?.type&&{property:"type"}]},{BaseComputedField:j=Object}=JetFBComponents,{sprintf:R,__:x}=wp.i18n,M=e=>{const{insert_custom_content_type:t={}}=e?.settings;return t.type};function I(){j.call(this),this.getSupportedActions=function(){return["insert_custom_content_type"]},this.isSupported=function(e){return j.prototype.isSupported.call(this,e)&&M(e)},this.getName=function(){const e=this.hasInList?`_${this.action.id}`:"";return`inserted_cct_${M(this.action)}`+e},this.getHelp=function(){return R(x("A computed field from the <b>Insert/Update Custom Content Type Item (%s)</b> action.","jet-form-builder"),this.action.id)}}I.prototype=Object.create(j.prototype);const B=I,O=window.wp.hooks;(0,c.register)(_),(0,s.registerAction)(S),(0,s.addComputedField)(B),(0,O.addFilter)("jet.fb.preset.editor.custom.condition","jet-engine/cct-query-var",(function(e,t,n){return"cct_query_var"===t?"custom_content_type"===n.from&&"query_var"===n.post_from:e}))})();
//# sourceMappingURL=jet-forms-v2.js.map